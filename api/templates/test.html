{% extends 'base.html' %}

{% block title %}
Register a New User
{% endblock %}

{% block content %}

<!--<form action="">-->
<!--    <input type="file" id="mediaInput">-->
<!--    <button type="submit">POST IMAGE</button>-->
<!--</form>-->
<img src="" id="retrieved">
<button onclick="func()">POOOOOOOOST REQUEST</button>

{% csrf_token %}

{% load static %}
<script>
    async function func() {
        const csrfToken = document.querySelector(
            "[name=csrfmiddlewaretoken]"
        ).value;
        const imgEl = document.getElementById('retrieved')
        let imageUrl = await fetch("/api/media/42/", {
            method: "GET",
            headers: {
                "X-CSRFToken": csrfToken,
            },
        }).then((response) => {
            const contentType = response.headers.get("content-type");
            if (contentType && contentType.startsWith("image/")) {
                var blob = response.blob()
                return blob;
            }
        }).then((blob) => {
            var imageUrl = window.URL.createObjectURL(blob);
            console.log(imageUrl);
            return imageUrl

        });
        imgEl.src = imageUrl
    }
</script>

<!-- Just saving code for later below -->

<!-- <script>
    skillsList.style.removeProperty('display');
    const skillsListRect = skillsList.getBoundingClientRect();
    const absoluteSkillsBottom = skillsListRect.bottom + window.pageYOffset;
    skillsList.style.display = 'none';

    const observer = new MutationObserver((mutationList, observer) => {
        for (const mutation of mutationList) {
            if (mutation.type === "attributes") {
                window.scrollTo({
                    top: absoluteSkillsBottom,
                    behavior: 'smooth'
                });
                console.log(mutation.attributeName)
                console.log(mutation)
            }
        }
    });

    const observeConfig = { attributes: true };

    observer.observe(skillsList, observeConfig);
</script> -->

{% endblock %}